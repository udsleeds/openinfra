<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Get, Use and Understand Open Data on Transport Infrastructure • openinfra</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Get, Use and Understand Open Data on Transport Infrastructure">
<meta property="og:description" content="What the package does (one paragraph) - todo...">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">openinfra</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/openinfra.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/osmintro.html">An introduction to getting and using OSM data for transport planning</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level1">
<div class="page-header"><h1 id="open-access-data-for-transport-research-tools-modelling-and-simulation">Open access data for transport research: tools, modelling and simulation<a class="anchor" aria-label="anchor" href="#open-access-data-for-transport-research-tools-modelling-and-simulation"></a>
</h1></div>
</div>
<div class="section level1">
<h1 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h1>
<p>Getting people walking and cycling has become a priority for many local, regional and national governments in recent years. Interventions boosting physical activity represent a ‘magic bullet’, tackling obesity, air pollution and wellbeing. Active travel is a rapidly growing topic of multi-disciplinary research but has received limited attention from data science perspectives, with a recent paper on modelling cycle network growth (Orozco et al. 2020) providing a notable exception. The work will be grounded in geographic data science, building on previous studies assessing open datasets for transport applications (Ferster et al. 2020; Haklay 2010).</p>
<p>In the post-pandemic world, active modes will be even more important due to reduced public transport capacities, as highlighted by the Department for Transport’s £250m Active Travel Fund (ATF) and £2b allocated to walking and cycling over the next 5 years in the UK alone.</p>
<p>New policies and investment programs such as the ATF have led to increased demand for local evidence to inform interventions ranging from new cycleways to improved pavement quality. This project will the potential of open access transport sources such as OpenStreetMap (OSM) and Ordnance Survey Open Roads (OSOR) datasets, and associated tools, for transport planning to meet active travel objectives. Specifically, the project will explore how open datasets can be used to understand, prioritise and design active travel infrastructure, such as cycleways, pavements, crossing points and traffic-calming features. The overall aim is to research and add value to open transport infrastructure data — and OpenStreetMap data in particular — for use in transport planning. The outputs will include new insights, ideas and datasets, leading to a step change in the accessibility, utility and understanding of crowd source data for evidence-based decision making.</p>
</div>
<div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>This repo contains code and example data to explore the utility of open data for transport planning and, specifically, open data on transport infrastructure. It was created to support a 12 month LIDA internship, the objectives of which are to:</p>
<ol style="list-style-type: decimal">
<li>develop new methods for bulk downloading, querying and analysing OpenStreetMap data on transport infrastructure</li>
<li>assess the quality of OSM data with reference to ‘ground truth’ datasets including data from satellite imagery and Ordnance Survey data</li>
<li>develop a typology of transport infrastructure data and data schemas for each infrastructure type and an actionable definition of ‘active travel infrastructure’</li>
<li>articulate ideas on how future research, datasets, software and tools could add value to open transport infrastructure data and support sustainable transport planning practice</li>
<li>publish reproducible methods and documentation on using OSM data for transport planning with reference to the strengths and potential pitfalls of the data</li>
<li>develop ‘OSM transport infrastructure data packs’ for every transport authority in Great Britain, with layers reflecting a typology of transport infrastructure data developed in the project</li>
<li>develop and publish guidance on using OSM data for transport planning</li>
<li>suggest a research agenda to enable better use of existing open datasets on transport infrastructure and envision future developments that could make transport planning more transparent, reproducible and participatory</li>
</ol>
<p>The internship will be undertaken in two 6 month phases, with a rough plan being for objectives 1:4 to be tackled during months 1:6 and objectives 5:8 to be tackled during months 7:12. An agile approach will be taken whereby objectives can be changed during the internship to pursue promising avenues that emerge.</p>
<p>There are already good tools open tools for working with transport infrastructure data, including the R packages <a href="https://docs.ropensci.org/osmextract/" class="external-link"><code>osmextract</code></a>, <a href="https://docs.ropensci.org/stplanr/" class="external-link"><code>stplanr</code></a>, and <a href="https://luukvdmeer.github.io/sfnetworks/" class="external-link"><code>sfnetworks</code></a>. These, and packages written in other languages such as Julia and Python, are largely academic-led and technical projects with little uptake among practitioners. This project will explore the landscape of open transport infrastructure, describe and critique how active travel infrastructure is represented, and document how practitioners can better use open data for evidence-based, transparent and participatory active travel interventions.</p>
<p>Local authority planners and other stakeholders have more data than ever before on transport systems to support their work, especially in relation to travel <em>behaviour</em> thanks to datasets from traffic counts, travel surveys and open access tools such as the Propensity to Cycle Tool</p>
<p>However, there is less accessible data on travel <em>infrastructure</em>, especially in relation to walking and cycling. Good practice on designing for active travel is well known (Department for Transport 2007; Parkin 2018) and increasingly recommended/enforced. Recent government publications provide clear guidance on design parameter for active travel infrastructure, with the recent ‘<a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/904088/cycle-infrastructure-design-ltn-1-20.pdf" class="external-link">Cycle infrastructure design</a>’ guidance from the Department for Transport specifying ‘desirable’ and ‘absolute’ minimum widths of cycleways of 1.5m and 2m on cycleways with low levels of cycle traffic, for example (Department for Transport 2020). However, little is known about the extent to which new infrastructure is compliant with such guidance: there is no open data on cycleway widths in most parts of the UK, leading to new approaches to assess compliance using region-specific datasets (Tait et al. 2022). Furthermore, new tools building on OSM datasets have been developed, for example to model change in transport infrastructure, prioritise road space reallocation schemes, and identify ‘low traffic neighbourhoods’ (e.g. Lovelace 2021; Lovelace et al. 2020; Lucas-Smith 2021). The internship will generate new research and publications on additional uses of open data to support sustainable transport planning objectives.</p>
</div>
<div class="section level1">
<h1 id="example-of-transport-infrastructure-in-r">Example of transport infrastructure in R<a class="anchor" aria-label="anchor" href="#example-of-transport-infrastructure-in-r"></a>
</h1>
<p>The brief example below shows how quickly you can get started with OSM data using command-line driven open source software to ensure reproducibility and scalability, based on an example put together for <a href="https://github.com/Robinlovelace/openTransportDataDemo" class="external-link">ODI Manchester</a>.</p>
<p>If you’re new to R, it may be worth reading up on introductory material such as the free and open source resource <em>Reproducible Road Safety with R</em> (Lovelace 2020) tutorial. See <a href="https://itsleeds.github.io/rrsrr/introduction.html#installing-r-and-rstudio" class="external-link">Section 1.5</a> of that tutorial to install R/RStudio and <a href="https://itsleeds.github.io/rrsrr/rstudio.html" class="external-link">Section 3</a> on getting started with the powerful RStudio editor. A strength of R is the number of high quality and open access <a href="https://education.rstudio.com/learn/beginner/" class="external-link">tutorials</a>, <a href="https://education.rstudio.com/learn/beginner/" class="external-link">books</a> and videos to get started.</p>
<p>With R installed, you should be able to run all the code in this example and reproduce the results.</p>
<p>The first step is to install some packages, by entering the following commands into the R console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pkgs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"pct"</span>,
  <span class="st">"stats19"</span>,
  <span class="st">"osmextract"</span>,
  <span class="st">"tmap"</span>,
  <span class="st">"stplanr"</span>,
  <span class="st">"od"</span>,
  <span class="st">"dplyr"</span>
<span class="op">)</span></code></pre></div>
<p>Install these packages as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span></code></pre></div>
<p>Load the packages one-by-one with <code><a href="https://itsleeds.github.io/pct/" class="external-link">library(pct)</a></code> etc, or all at once as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">pkgs</span>, <span class="va">library</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; Data provided under OGL v3.0. Cite the source and link to:</span>
<span class="co">#&gt; www.nationalarchives.gov.uk/doc/open-government-licence/version/3/</span>
<span class="co">#&gt; Data (c) OpenStreetMap contributors, ODbL 1.0. https://www.openstreetmap.org/copyright.</span>
<span class="co">#&gt; Check the package website, https://docs.ropensci.org/osmextract/, for more details.</span>
<span class="co">#&gt; Warning in fun(libname, pkgname): rgeos: versions of GEOS runtime 3.10.1-CAPI-1.16.0</span>
<span class="co">#&gt; and GEOS at installation 3.9.1-CAPI-1.14.2differ</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'od'</span>
<span class="co">#&gt; The following objects are masked from 'package:stplanr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     od_id_character, od_id_max_min, od_id_order, od_id_szudzik,</span>
<span class="co">#&gt;     od_oneway, od_to_odmatrix, odmatrix_to_od</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;  [1] "dplyr"      "od"         "stplanr"    "osmextract" "stats19"   </span>
<span class="co">#&gt;  [6] "pct"        "tmap"       "sf"         "stats"      "graphics"  </span>
<span class="co">#&gt; [11] "grDevices"  "utils"      "datasets"   "methods"    "base"</span></code></pre></div>
<p>One final line of code to set-up the environment is to switch <code>tmap</code> into ‘view’ mode if you want to create interactive maps:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"view"</span><span class="op">)</span>
<span class="co">#&gt; tmap mode set to interactive viewing</span></code></pre></div>
<p>We will select the Worseley Building, home of LIDA, as the case study area. As a starting point, we will use a 2 km buffer around the straight line between LIDA and Leeds city centre to capture movement along this transport corridor:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lida_point</span> <span class="op">=</span> <span class="fu">tmaptools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tmaptools/man/geocode_OSM.html" class="external-link">geocode_OSM</a></span><span class="op">(</span><span class="st">"Worsley Building, Leeds"</span><span class="op">)</span>
<span class="va">leeds_point</span> <span class="op">=</span> <span class="fu">tmaptools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tmaptools/man/geocode_OSM.html" class="external-link">geocode_OSM</a></span><span class="op">(</span><span class="st">"leeds"</span><span class="op">)</span>
<span class="va">c_m_coordiantes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">lida_point</span><span class="op">$</span><span class="va">coords</span>, <span class="va">leeds_point</span><span class="op">$</span><span class="va">coords</span><span class="op">)</span>
<span class="va">c_m_od</span> <span class="op">=</span> <span class="fu">od</span><span class="fu">::</span><span class="fu"><a href="https://itsleeds.github.io/od/reference/points_to_od.html" class="external-link">points_to_od</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">c_m_coordiantes</span>, interzone_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">c_m_desire_line</span> <span class="op">=</span> <span class="fu">od</span><span class="fu">::</span><span class="fu"><a href="https://itsleeds.github.io/od/reference/odc_to_sf.html" class="external-link">odc_to_sf</a></span><span class="op">(</span><span class="va">c_m_od</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>
<span class="va">lida_buffer</span> <span class="op">=</span> <span class="fu">stplanr</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/stplanr/reference/geo_buffer.html" class="external-link">geo_buffer</a></span><span class="op">(</span><span class="va">c_m_desire_line</span>, dist <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">qtm</span><span class="op">(</span><span class="va">lida_buffer</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span><span class="va">lida_buffer</span>, <span class="st">"lida_buffer.geojson"</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="transport-infrastructure-data-from-osmextract">Transport infrastructure data from osmextract<a class="anchor" aria-label="anchor" href="#transport-infrastructure-data-from-osmextract"></a>
</h2>
<p>The following commands get transport infrastructure data. See documentation on the <a href="https://docs.ropensci.org/osmextract/index.html" class="external-link"><code>osmextract</code> website</a> for details.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">osm_data_full</span> <span class="op">=</span> <span class="fu">osmextract</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/osmextract/reference/oe_get.html" class="external-link">oe_get</a></span><span class="op">(</span><span class="va">lida_buffer</span>, extra_tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"maxspeed"</span>, <span class="st">"lanes"</span><span class="op">)</span><span class="op">)</span>
<span class="va">osm_data_region</span> <span class="op">=</span> <span class="va">osm_data_full</span><span class="op">[</span><span class="va">lida_buffer</span>, , op <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="va"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">st_within</a></span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">osm_data_region</span><span class="op">$</span><span class="va">highway</span><span class="op">)</span><span class="op">)</span>
<span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span>
<span class="fu">tm_shape</span><span class="op">(</span><span class="va">osm_data_region</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">tm_lines</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"highway"</span><span class="op">)</span>
<span class="fu">tmap_save</span><span class="op">(</span><span class="va">.Last.value</span>, <span class="st">"osm_highway_map.png"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/osm_highway_map.png"></p>
<p>The same approach can be used to get building polygons:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q</span> <span class="op">=</span> <span class="st">"select * from multipolygons where building in ('house', 'residential', 'office', 'commercial', 'detached', 'yes')"</span>
<span class="va">osm_data_polygons</span> <span class="op">=</span> <span class="fu">osmextract</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/osmextract/reference/oe_get.html" class="external-link">oe_get</a></span><span class="op">(</span><span class="va">zones</span>, query <span class="op">=</span> <span class="va">q</span><span class="op">)</span>
<span class="va">osm_data_polygons_region</span> <span class="op">=</span> <span class="va">osm_data_polygons</span><span class="op">[</span><span class="va">lida_buffer</span>, , op <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="va"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">st_within</a></span><span class="op">]</span>
<span class="fu">qtm</span><span class="op">(</span><span class="va">zones</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">qtm</span><span class="op">(</span><span class="va">osm_data_polygons_region</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">osm_data_polygons_region</span>, <span class="st">"osm_data_polygons_region.Rds"</span><span class="op">)</span></code></pre></div>
<p>There is lots more we can do with this data and other open transport datasets, and this project looks set to identify and document some of the most important uses for sustainable transport planning.</p>
<!-- ## Zone data from the PCT -->
<!-- The Propensity to Cycle Tool (PCT) is a research project and web application that provides data on transport patterns at high levels of geographic resolution across England and Wales. -->
<!-- The PCT is the main national tool that highway authorities use to support strategic cycle network plans and to ensure that investment goes in places, and transport corridors, with high cycling potential. -->
<!-- You can use the PCT in a web browser by navigating to www.pct.bike and clicking on a region of interest. -->
<!-- By making model results publicly the PCT enables more stakeholders to engage in the transport planning process than do proprietary tools only available to a handful of people with expensive licenses [@lovelace_open_2020]. -->
<!-- The PCT is also an open data project, and you can download data for any region in England and Wales in the Region data tab when using the tool. -->
<!-- You can also download data programmatically using the `pct` R package to enable others to build on the tool using the statistical programming language in which it was built. -->
<!-- This section demonstrates how to get and visualise key transport datasets from the PCT. -->
<!-- ```{r} -->
<!-- head(pct::pct_regions$region_name) -->
<!-- # zones = pct::get_pct_zones("west-yorkshire") # for smaller LSOA zones -->
<!-- zones = pct::get_pct_zones("west-yorkshire", geography = "msoa") -->
<!-- names(zones)[1:20] -->
<!-- names_to_plot = c("bicycle", "foot", "car_driver", "bus") -->
<!-- plot(zones[names_to_plot]) -->
<!-- ``` -->
<!-- To keep only zones whose centroids lie inside the study area we can use the following spatial subsetting code: -->
<!-- ```{r} -->
<!-- zone_centroids = sf::st_centroid(zones) -->
<!-- zone_centroids_lida = zone_centroids[lida_buffer, ] -->
<!-- zones = zones[zones$geo_code %in% zone_centroids_lida$geo_code, ] -->
<!-- saveRDS(zones, "zones.Rds") -->
<!-- ``` -->
<!-- Let's plot the result, to get a handle on the level of walking and cycling in the area (see interactive version of this map [here](https://rpubs.com/RobinLovelace/772770), shown are LSOA results): -->
<!-- ```{r, eval=FALSE} -->
<!-- tm_shape(zones) + -->
<!--   tm_fill(c("foot", "bicycle"), palette = "viridis") + -->
<!--   tm_shape(lida_buffer) + tm_borders(lwd = 3) -->
<!-- ``` -->
<!-- ![](https://i.imgur.com/oEuv1Zj.png) -->
<!-- ## Desire line data from the pct package -->
<!-- The maps shown in the previous section establish that there is a decent amount of cycling in the Chorlton area, at least according to the 2011 Census which is still a good proxy for travel patterns in 2021 due to the inertia of travel behaviours to change [@goodman_walking_2013]. -->
<!-- You can get national OD (origin/destination, also called desire line) data from the Census into R with the following command: -->
<!-- ```{r} -->
<!-- od_national = pct::get_od() -->
<!-- od_national -->
<!-- ``` -->
<!-- Let's keep only OD data that have a start and end point in the study area (in a transport simulation, we may also want trips starting or ending outside this area and passing through): -->
<!-- ```{r} -->
<!-- od = od_national %>%  -->
<!--   filter(geo_code1 %in% zones$geo_code) %>%  -->
<!--   filter(geo_code2 %in% zones$geo_code) -->
<!-- dim(od) -->
<!-- ``` -->
<!-- The result is nearly 300 rows of data representing movement between origin and destination zone centroids. -->
<!-- The data is non geographic, however. -->
<!-- To convert this non-geographic data into geographic desire lines, you can use the `od_to_sf()` function in the `od` package as follows: -->
<!-- ```{r} -->
<!-- desire_lines = od::od_to_sf(x = od, z = zones) -->
<!-- ``` -->
<!-- We'll calculated the straight line distance of these trips as follows: -->
<!-- ```{r} -->
<!-- desire_lines$length_km = as.numeric(sf::st_length(desire_lines)) / 1000 -->
<!-- summary(desire_lines$length_km) -->
<!-- ``` -->
<!-- We can plot the result as follows: -->
<!-- ```{r} -->
<!-- tmap_mode("plot") -->
<!-- qtm(zones) + -->
<!--   tm_shape(desire_lines) + -->
<!--   tm_lines(c("foot", "bicycle"), palette = "Blues", style = "jenks", lwd = 3, alpha = 0.5) -->
<!-- ``` -->
<!-- Note the OD data describes an aggregate pattern, between pairs of zones -- not between individual points-of-interest. -->
<!-- The following code returns only OD pairs with an origin in the Chorlton area: -->
<!-- ```{r} -->
<!-- od_lida = od %>%  -->
<!--   filter(geo_code1 %in% "E02001073") -->
<!-- ``` -->
<!-- ## Crash data from stats19 -->
<!-- A major deterrent to walking and cycling is motor traffic. -->
<!-- You can get open data on road traffic casulaties in the case study area over the last five years as follows: -->
<!-- ```{r, eval=FALSE} -->
<!-- library(stats19) -->
<!-- crashes = get_stats19(year = 2015:2019, output_format = "sf", lonlat = TRUE) -->
<!-- casualties = get_stats19(year = 2015:2019, type = "casualties") -->
<!-- crashes_combined = inner_join(crashes, casualties) -->
<!-- table(crashes_combined$casualty_type) -->
<!-- crashes_active = crashes_combined %>%  -->
<!--   filter(casualty_type %in% c("Pedestrian", "Cyclist")) -->
<!-- crashes_in_area = crashes_active[lida_buffer, ] -->
<!-- tm_shape(crashes_in_area) + -->
<!--   tm_dots("casualty_type", popup.vars = c("casualty_type", "accident_severity", "datetime"), palette = "viridis") -->
<!-- ``` -->
<!-- ![](https://i.imgur.com/oTYSwzQ.png) -->
<!-- ```{r, eval=FALSE, echo=FALSE} -->
<!-- sf::write_sf(crashes_in_area, "crashes_in_area.geojson") -->
<!-- piggyback::pb_upload("crashes_in_area.geojson") -->
<!-- piggyback::pb_download_url("crashes_in_area.geojson") -->
<!-- ``` -->
<!-- You can get the resulting crash data from: https://github.com/Robinlovelace/openTransportDataDemo/releases/download/1/crashes_in_area.geojson -->
<!-- ## Scenarios of change -->
<!-- You can model cycling uptake functions with the `pct` package as follows: -->
<!-- ```{r} -->
<!-- percent_cycling = pct::uptake_pct_godutch_2020(distance = desire_lines$length_km, gradient = 0) -->
<!-- plot(desire_lines$length_km, percent_cycling) -->
<!-- ``` -->
<!-- To get more realistic results, you would use route (not straight line) distance and hilliness from actual routes, not just desire lines. -->
<!-- Routing takes time but can be done with R packages such as `stplanr`. -->
<!-- For the purposes of illustration, we will use a simple uptake model implemented below: -->
<!-- ```{r} -->
<!-- desire_lines_go_active = desire_lines %>%  -->
<!--   mutate(car_driver = case_when(length_km < 2 ~ car_driver * 0.33, TRUE ~ car_driver)) %>%  -->
<!--   mutate(foot = case_when(length_km < 2 ~ foot + car_driver * (1 - 0.33), TRUE ~ foot)) %>%  -->
<!--   mutate(car_driver = car_driver * 0.5, bicycle = bicycle + car_driver * 0.5) %>%  -->
<!--   mutate_if(is.numeric, round) -->
<!-- sum(desire_lines_go_active$bicycle) -->
<!-- sum(desire_lines$bicycle) -->
<!-- sum(desire_lines_go_active$foot) -->
<!-- sum(desire_lines$foot) -->
<!-- ``` -->
<!-- ## Preparing data for A/B Street -->
<!-- ```{r, fig.show='hold', out.width="49%"} -->
<!-- remotes::install_github("a-b-street/abstr", ref = "ab_scenario2") -->
<!-- u = "https://github.com/Robinlovelace/openTransportDataDemo/releases/download/1/osm_data_polygons_region.Rds" -->
<!-- f = basename(u) -->
<!-- if(!file.exists(f)) { -->
<!--   download.file(url = u, destfile = f) -->
<!-- } -->
<!-- osm_data_polygons_region = readRDS("osm_data_polygons_region.Rds") -->
<!-- # Explore inputs and outputs of ab_scenario fun -->
<!-- desire_lines_abst = desire_lines %>%  -->
<!--   filter(geo_code1 == "E02001073") %>%  -->
<!--   transmute(o = geo_code1, d = geo_code2, all, Walk = foot, Bike = bicycle, Drive = car_driver, -->
<!--          Transit = light_rail + train + bus) -->
<!-- set.seed(2050) -->
<!-- desire_lines_disaggregated = abstr::ab_scenario(desire_lines_abst, zones = zones, -->
<!--                                                   subpoints = osm_data_polygons_region) -->
<!-- desire_lines_disaggregated %>%  -->
<!--  tm_shape() + -->
<!--   tm_lines("mode") + -->
<!--   qtm(osm_data_polygons_region) -->
<!-- desire_lines_json = abstr::ab_json(desire_lines_disaggregated["mode"], scenario_name = "baseline") -->
<!-- abstr::ab_save(x = desire_lines_json, "baseline.json") -->
<!-- # Go Active scenario -->
<!-- desire_lines_abst = desire_lines_go_active %>%  -->
<!--   filter(geo_code1 == "E02001073") %>%  -->
<!--   transmute(o = geo_code1, d = geo_code2, all, Walk = foot, Bike = bicycle, Drive = car_driver, -->
<!--          Transit = light_rail + train + bus) -->
<!-- set.seed(2050) -->
<!-- desire_lines_disaggregated = abstr::ab_scenario(desire_lines_abst, zones = zones, -->
<!--                                                   subpoints = osm_data_polygons_region) -->
<!-- desire_lines_disaggregated %>%  -->
<!--  tm_shape() + -->
<!--   tm_lines("mode") + -->
<!--   qtm(osm_data_polygons_region) -->
<!-- desire_lines_json = abstr::ab_json(desire_lines_disaggregated["mode"], scenario_name = "go_active") -->
<!-- abstr::ab_save(x = desire_lines_json, "go_active.json") -->
<!-- ``` -->
<!-- ```{r, eval=FALSE, echo=FALSE} -->
<!-- piggyback::pb_upload("go_active.json") -->
<!-- piggyback::pb_download_url("go_active.json") -->
<!-- fs::file_size("baseline.json") -->
<!-- # Explore inputs and outputs of ab_scenario fun -->
<!-- desire_lines_disaggregated = abstr::ab_scenario(desire_lines_abst, zones = zones) -->
<!-- piggyback::pb_upload("osm_data_polygons_region.Rds") -->
<!-- piggyback::pb_download_url("osm_data_polygons_region.Rds") -->
<!-- desire_lines_json = ab_json(desire_lines_disaggregated["mode"], scenario_name = "baseline") -->
<!-- ab_save(x = desire_lines_json, "baseline.json") -->
<!-- fs::file_size("baseline.json") -->
<!-- library(abstr) -->
<!-- ?ab_scenario -->
<!-- ab_evening_dutch = ab_scenario2( -->
<!--   leeds_houses, -->
<!--   leeds_buildings, -->
<!--   leeds_desire_lines, -->
<!--   leeds_zones, -->
<!--   scenario = "dutch", -->
<!--   output_format = "sf", -->
<!--   hr = 20, # representing 8 pm -->
<!--   sd = 0 -->
<!-- ) -->
<!-- head(leeds_desire_lines) -->
<!-- head(ab_evening_dutch) # output is simple: sf object with `mode` column. -->
<!-- nrow(ab_evening_dutch) -->
<!-- sum(leeds_desire_lines$all_base) -->
<!-- # issue to fix here:  -->
<!-- zones = zones %>%  -->
<!--   filter(geo_name %in% c(desire_lines$geo_code1, desire_lines$geo_code2)) -->
<!-- desire_lines_json = ab_json(desire_lines_disaggregated["mode"], scenario_name = "baseline") -->
<!-- ``` -->
</div>
</div>
<div class="section level1">
<h1 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h1>
<ul>
<li>To get started with R for transport research I recommend Reproducible Road Safety Research with R, an online version of which can be found here: <a href="https://itsleeds.github.io/rrsrr/" class="external-link uri">https://itsleeds.github.io/rrsrr/</a>
</li>
<li>To get a deeper understanding of using geographic research transport research, Chapter 12 of the book Geocomputation with R is a great place to start: <a href="https://geocompr.robinlovelace.net/transport.html" class="external-link uri">https://geocompr.robinlovelace.net/transport.html</a>
</li>
<li>For more on A/B Street scenarios, see here: <a href="https://a-b-street.github.io/docs/dev/formats/scenarios.html" class="external-link uri">https://a-b-street.github.io/docs/dev/formats/scenarios.html</a>
</li>
</ul>
<p>For any questions, feel free to ask in a GitHub issue track assocated with any of the repositories mentioned in this guide.</p>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-departmentfortransport_manual_2007" class="csl-entry">
<p>Department for Transport. 2007. “Manual for Streets.” London: Telford. <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/341513/pdfmanforstreets.pdf" class="external-link uri">https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/341513/pdfmanforstreets.pdf</a>.</p>
</div>
<div id="ref-departmentfortransport_cycle_2020" class="csl-entry">
<p>———. 2020. “Cycle Infrastructure Design (LTN 1/20).” 1/20. Local Transport Note. London. <a href="https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/904088/cycle-infrastructure-design-ltn-1-20.pdf" class="external-link uri">https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/904088/cycle-infrastructure-design-ltn-1-20.pdf</a>.</p>
</div>
<div id="ref-ferster_using_2020" class="csl-entry">
<p>Ferster, Colin, Jaimy Fischer, Kevin Manaugh, Trisalyn Nelson, and Meghan Winters. 2020. “Using OpenStreetMap to Inventory Bicycle Infrastructure: A Comparison with Open Data from Cities.” <em>International Journal of Sustainable Transportation</em> 14 (1): 64–73. <a href="https://doi.org/10.1080/15568318.2018.1519746" class="external-link uri">https://doi.org/10.1080/15568318.2018.1519746</a>.</p>
</div>
<div id="ref-haklay_how_2010a" class="csl-entry">
<p>Haklay, Mordechai. 2010. “How Good Is Volunteered Geographical Information? A Comparative Study of OpenStreetMap and Ordnance Survey Datasets.” <em>Environment and Planning B: Planning and Design</em> 37 (4): 682–703. <a href="https://doi.org/10.1068/b35097" class="external-link uri">https://doi.org/10.1068/b35097</a>.</p>
</div>
<div id="ref-lovelace_reproducible_2020" class="csl-entry">
<p>Lovelace, Robin. 2020. “Reproducible Road Safety Research with R.” Royal Automotive Club Foundation. <a href="https://www.racfoundation.org/wp-content/uploads/Reproducible_road_safety_research_with_R_Lovelace_December_2020.pdf" class="external-link uri">https://www.racfoundation.org/wp-content/uploads/Reproducible_road_safety_research_with_R_Lovelace_December_2020.pdf</a>.</p>
</div>
<div id="ref-lovelace_open_2021" class="csl-entry">
<p>———. 2021. “Open Source Tools for Geographic Analysis in Transport Planning.” <em>Journal of Geographical Systems</em>, January. <a href="https://doi.org/10.1007/s10109-020-00342-2" class="external-link uri">https://doi.org/10.1007/s10109-020-00342-2</a>.</p>
</div>
<div id="ref-lovelace_methods_2020" class="csl-entry">
<p>Lovelace, Robin, Joseph Talbot, Malcolm Morgan, and Martin Lucas-Smith. 2020. “Methods to Prioritise Pop-up Active Transport Infrastructure.” <em>Transport Findings</em>, July, 13421. <a href="https://doi.org/10.32866/001c.13421" class="external-link uri">https://doi.org/10.32866/001c.13421</a>.</p>
</div>
<div id="ref-lucas-smith_mapping_2021" class="csl-entry">
<p>Lucas-Smith, Martin. 2021. “Mapping Modal Filters and LTNs.” CycleStreets. July 25, 2021. <a href="https://www.cyclestreets.org/news/2021/07/25/mapping-ltns/" class="external-link uri">https://www.cyclestreets.org/news/2021/07/25/mapping-ltns/</a>.</p>
</div>
<div id="ref-orozco_datadriven_2020" class="csl-entry">
<p>Orozco, Luis, Federico Battiston, Gerardo Iñiguez, and Michael Szell. 2020. “Data-Driven Strategies for Optimal Bicycle Network Growth.” <em>Royal Society Open Science</em> 7 (December): 201130. <a href="https://doi.org/10.1098/rsos.201130" class="external-link uri">https://doi.org/10.1098/rsos.201130</a>.</p>
</div>
<div id="ref-parkin_designing_2018" class="csl-entry">
<p>Parkin, John. 2018. <em>Designing for Cycle Traffic: International Principles and Practice</em>. ICE Publishing. <a href="https://www.icevirtuallibrary.com/isbn/9780727763495" class="external-link uri">https://www.icevirtuallibrary.com/isbn/9780727763495</a>.</p>
</div>
<div id="ref-tait_cycling_2022" class="csl-entry">
<p>Tait, Caroline, Roger Beecham, Robin Lovelace, and Stuart Barber. 2022. “Is Cycling Infrastructure in London Safe and Equitable? Evidence from the Cycling Infrastructure Database.”</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing openinfra</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Greta Timaite <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5679-1111" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Lovelace <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-5679-6536" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/udsleeds/openinfra/actions" class="external-link"><img src="https://github.com/udsleeds/openinfra/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Greta Timaite, Robin Lovelace.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
